(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))u(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&u(i)}).observe(document,{childList:!0,subtree:!0});function e(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function u(o){if(o.ep)return;o.ep=!0;const r=e(o);fetch(o.href,r)}})();function k(n){return document.createElement(n)}var R,S=[];function B(n,t){var e=Date.now(),u=e+n,o=u+t,r={start:u,end:o};S.push(r),R||(R=!0,requestAnimationFrame(nn));var i={start:function(s){return r.startcb=s,i},progress:function(s){return r.progresscb=s,i},end:function(s){return r.endcb=s,i}};return i}function nn(){var n=Date.now();if(!S.length){R=!1;return}for(var t=0,e;t<S.length;t++)if(e=S[t],!(n<e.start)){e.started||(e.started=!0,e.startcb&&e.startcb());var u=(n-e.start)/(e.end-e.start);if(e.progresscb&&e.progresscb(u<1?u:1),n>e.end){e.endcb&&e.endcb(),S.splice(t--,1);continue}}requestAnimationFrame(nn)}window.requestAnimationFrame||(window.requestAnimationFrame=function(n){setTimeout(n,0)});const en={linear:function(n){return n},quadIn:function(n){return n*n},quadOut:function(n){return n*(2-n)},quadInOut:function(n){return n<.5?2*n*n:-1+(4-2*n)*n},cubicIn:function(n){return n*n*n},cubicOut:function(n){return--n*n*n+1},cubicInOut:function(n){return n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1},quartIn:function(n){return n*n*n*n},quartOut:function(n){return 1- --n*n*n*n},quartInOut:function(n){return n<.5?8*n*n*n*n:1-8*--n*n*n*n},quintIn:function(n){return n*n*n*n*n},quintOut:function(n){return 1+--n*n*n*n*n},quintInOut:function(n){return n<.5?16*n*n*n*n*n:1+16*--n*n*n*n*n}};function I(){return window.getComputedStyle(document.body).getPropertyValue("font-size").slice(0,-2)}var D;const sn={deck:function(n){n.bysuit=n.queued(t);function t(e){var u=n.cards;D=I(),u.forEach(function(o){o.bysuit(function(r){r===u.length-1&&e()})})}},card:function(n){var t=n.rank,e=n.suit;n.bysuit=function(u){var o=n.i,r=o*10;n.animateTo({delay:r,duration:400,x:-Math.round((6.75-t)*8*D/16),y:-Math.round((1.5-e)*92*D/16),rot:0,onComplete:function(){u(o)}})}}};var Y;const fn={deck:function(n){n.fan=n.queued(t);function t(e){var u=n.cards,o=u.length;Y=I(),u.forEach(function(r,i){r.fan(i,o,function(s){s===u.length-1&&e()})})}},card:function(n){var t=n.$el;n.fan=function(e,u,o){var r=e/4,i=e*10,s=e/(u-1)*260-130;n.animateTo({delay:i,duration:300,x:-r,y:-r,rot:0}),n.animateTo({delay:300+i,duration:300,x:Math.cos(Q(s-90))*55*Y/16,y:Math.sin(Q(s-90))*55*Y/16,rot:s,onStart:function(){t.style.zIndex=e},onComplete:function(){o(e)}})}}};function Q(n){return n*Math.PI/180}var W=document.createElement("p").style,M={};function O(n){if(typeof M[n]<"u")return M[n];if(typeof W[n]<"u")return M[n]=n,n;for(var t=n[0].toUpperCase()+n.slice(1),e=["webkit","moz","Moz","ms","o"],u,o=0,r=e.length;o<r;o++)if(u=e[o]+t,typeof W[u]<"u")return M[n]=u,u}var m;function $(n,t,e){return typeof m<"u"||(m=cn()),e=e||0,m?"translate3d("+n+", "+t+", "+e+")":"translate("+n+", "+t+")"}function cn(){var n=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);if(!n)return!1;var t=O("transform"),e=document.createElement("p");return document.body.appendChild(e),e.style[t]="translate3d(1px,1px,1px)",m=e.style[t],m=m!=null&&m.length&&m!=="none",document.body.removeChild(e),m}const ln={deck:function(n){n.intro=n.queued(t);function t(e){var u=n.cards;u.forEach(function(o,r){o.setSide("front"),o.intro(r,function(i){B(250,0).start(function(){o.setSide("back")}),i===u.length-1&&e()})})}},card:function(n){var t=O("transform"),e=n.$el;n.intro=function(u,o){var r=500+u*10,i=u/4;e.style[t]=$(-i+"px","-250px"),e.style.opacity=0,n.x=-i,n.y=-250-i,n.rot=0,n.animateTo({delay:r,duration:1e3,x:-i,y:-i,onStart:function(){e.style.zIndex=u},onProgress:function(s){e.style.opacity=s},onComplete:function(){e.style.opacity="",o&&o(u)}})}}};var X;const dn={deck:function(n){n.poker=n.queued(t);function t(e){var u=n.cards,o=u.length;X=I(),u.slice(-5).reverse().forEach(function(r,i){r.poker(i,o,function(s){r.setSide("front"),s===4&&e()})})}},card:function(n){var t=n.$el;n.poker=function(e,u,o){var r=e*250;n.animateTo({delay:r,duration:250,x:Math.round((e-2.05)*70*X/16),y:Math.round(-110*X/16),rot:0,onStart:function(){t.style.zIndex=u-1+e},onComplete:function(){o(e)}})}}};function vn(n){for(var t,e,u=n.length-1;u;u--)t=Math.random()*u|0,e=n[u],n[u]=n[t],n[t]=e;return n}function pn(n){var t=Math.round(Math.random())?-1:1;return t*n}var _;const yn={deck:function(n){n.shuffle=n.queued(t);function t(e){var u=n.cards;_=I(),vn(u),u.forEach(function(o,r){o.pos=r,o.shuffle(function(i){i===u.length-1&&e()})})}},card:function(n){var t=n.$el;n.shuffle=function(e){var u=n.pos,o=u/4,r=u*2;n.animateTo({delay:r,duration:200,x:pn(Math.random()*40+20)*_/16,y:-o,rot:0}),n.animateTo({delay:200+r,duration:200,x:-o,y:-o,rot:0,onStart:function(){t.style.zIndex=u},onComplete:function(){e(u)}})}}},mn={deck:function(n){n.sort=n.queued(t);function t(e,u){var o=n.cards;o.sort(function(r,i){return u?r.i-i.i:i.i-r.i}),o.forEach(function(r,i){r.sort(i,o.length,function(s){s===o.length-1&&e()},u)})}},card:function(n){var t=n.$el;n.sort=function(e,u,o,r){var i=e/4,s=e*10;n.animateTo({delay:s,duration:400,x:-i,y:-150,rot:0,onComplete:function(){t.style.zIndex=e}}),n.animateTo({delay:s+500,duration:400,x:-i,y:-i,rot:0,onComplete:function(){o(e)}})}}},hn={deck:function(n){n.flip=n.queued(t);function t(e,u){var o=n.cards.filter(function(r){return r.side==="front"}).length/n.cards.length;n.cards.forEach(function(r,i){r.setSide(u||(o>.5?"back":"front"))}),e()}}};function gn(n){n||(n={});var t={};return n.on=e,n.one=u,n.off=r,n.trigger=o,n;function e(i,s,f){t[i]||(t[i]=[]),t[i].push({cb:s,ctx:f})}function u(i,s,f){t[i]||(t[i]=[]),t[i].push({cb:s,ctx:f,once:!0})}function o(i){var s=this,f=Array.prototype.slice(arguments,1),v=t[i]||[];v.filter(function(a){return a.cb.apply(s,f),!a.once})}function r(i,s){if(!i){t={};return}if(!s){t[i]=[];return}t[i]=t[i].filter(function(f){return f.cb!==s})}}function xn(n){var t=Array.prototype,e=[];return n.queue=o,n.queued=u,n;function u(i){return function(){var s=this,f=arguments;o(function(v){i.apply(s,t.concat.apply(v,f))})}}function o(i){i&&(e.push(i),e.length===1&&r())}function r(){e[0](function(i){if(i)throw i;e=e.slice(1),e.length&&r()})}}var bn=52;function tn(n){var t=O("transform"),e=n%13+1,u=n/13|0,o=(52-n)/4,r=k("div"),i=k("div"),s=k("div"),f=!1,v=!1,a={i:n,rank:e,suit:u,pos:n,$el:r,mount:on,unmount:un,setSide:an},q=h.modules,g;i.classList.add("face"),s.classList.add("back"),r.style[t]=$(-o+"px",-o+"px"),a.x=-o,a.y=-o,a.z=o,a.rot=0,a.setSide("back"),w(r,"mousedown",j),w(r,"touchstart",j);for(g in q)rn(q[g]);return a.animateTo=function(c){var{delay:d,duration:l,x:L=a.x,y:x=a.y,rot:b=a.rot,ease:y,onStart:K,onProgress:U,onComplete:Z}=c,F,P,T,G,H,A;B(d,l).start(function(){F=a.x||0,P=a.y||0,T=a.rot||0,K&&K()}).progress(function(J){var C=en[y||"cubicInOut"](J);G=L-F,H=x-P,A=b-T,U&&U(J,C),a.x=F+G*C,a.y=P+H*C,a.rot=T+A*C,r.style[t]=$(a.x+"px",a.y+"px")+(A?"rotate("+a.rot+"deg)":"")}).end(function(){Z&&Z()})},a.setRankSuit=function(c,d){var l=wn(d);r.setAttribute("class","card "+l+" rank"+c)},a.setRankSuit(e,u),a.enableDragging=function(){f||(f=!0,r.style.cursor="move")},a.enableFlipping=function(){v||(v=!0)},a.disableFlipping=function(){v&&(v=!1)},a.disableDragging=function(){f&&(f=!1,r.style.cursor="")},a;function rn(c){c.card&&c.card(a)}function j(c){var d={},l={},L=Date.now();if(c.preventDefault(),c.type==="mousedown"?(d.x=l.x=c.clientX,d.y=l.y=c.clientY,w(window,"mousemove",x),w(window,"mouseup",b)):(d.x=l.x=c.touches[0].clientX,d.y=l.y=c.touches[0].clientY,w(window,"touchmove",x),w(window,"touchend",b)),!f)return;r.style[t]=$(a.x+"px",a.y+"px")+(a.rot?" rotate("+a.rot+"deg)":""),r.style.zIndex=bn++;function x(y){f&&(y.type==="mousemove"?(l.x=y.clientX,l.y=y.clientY):(l.x=y.touches[0].clientX,l.y=y.touches[0].clientY),r.style[t]=$(Math.round(a.x+l.x-d.x)+"px",Math.round(a.y+l.y-d.y)+"px")+(a.rot?" rotate("+a.rot+"deg)":""))}function b(y){v&&Date.now()-L<200&&a.setSide(a.side==="front"?"back":"front"),y.type==="mouseup"?(z(window,"mousemove",x),z(window,"mouseup",b)):(z(window,"touchmove",x),z(window,"touchend",b)),f&&(a.x=a.x+l.x-d.x,a.y=a.y+l.y-d.y)}}function on(c){c.appendChild(r),a.$root=c}function un(){a.$root&&a.$root.removeChild(r),a.$root=null}function an(c){c==="front"?(a.side==="back"&&r.removeChild(s),a.side="front",r.appendChild(i),a.setRankSuit(a.rank,a.suit)):(a.side==="front"&&r.removeChild(i),a.side="back",r.appendChild(s),r.setAttribute("class","card"))}}function wn(n){return n===0?"spades":n===1?"hearts":n===2?"clubs":n===3?"diamonds":"joker"}function w(n,t,e){n.addEventListener(t,e)}function z(n,t,e){n.removeEventListener(t,e)}function h(n){var t=new Array(n?55:52),e=k("div"),u=gn({mount:v,unmount:a,cards:t,$el:e}),o,r=h.modules,i;xn(u);for(i in r)q(r[i]);e.classList.add("deck");for(var s,f=t.length;f;f--)s=t[f-1]=tn(f-1),s.setSide("back"),s.mount(e);return u;function v(g){o=g,o.appendChild(e)}function a(){o.removeChild(e)}function q(g){g.deck&&g.deck(u)}}h.animationFrames=B;h.ease=en;h.modules={bysuit:sn,fan:fn,intro:ln,poker:dn,shuffle:yn,sort:mn,flip:hn};h.Card=tn;h.prefix=O;h.translate=$;var N;function $n(){return window.getComputedStyle(document.body).getPropertyValue("font-size").slice(0,-2)}const E={deck:function(n){n.deal=n.queued(t);function t(e){var u=n.cards,o=u.length;N=$n(),u.slice(-8).reverse().forEach(function(r,i){r.deal(i,o,function(s){s===7&&e()})})}},card:function(n){var t=n.$el;n.deal=function(e,u,o){var r=e*250,i=Math.round((e%4-.4)*N*5.25),s=Math.round(N*-9*Math.floor(e/4+1));n.animateTo({delay:r,duration:250,x:i,y:s,rot:0,onStart:function(){t.style.zIndex=u-1+e},onComplete:function(){o(e)}})}}};var Sn=document.getElementById("topbar"),V=document.createElement("button");V.textContent="發牌";Sn.appendChild(V);V.addEventListener("click",function(){p.queue(function(n){p.cards.forEach(function(t,e){setTimeout(function(){t.setSide("back")},e*7.5)}),n()}),p.shuffle(),p.shuffle(),p.deal()});var p=h();E.deck&&E.deck(p);console.log(p);var qn=p.cards.splice(10,42);qn.forEach(function(n){n.unmount()});for(let n of p.cards)E.card&&E.card(n),n.enableDragging(),n.$el.style.cursor="grab",n.enableFlipping();var Cn=document.getElementById("container");p.mount(Cn);
